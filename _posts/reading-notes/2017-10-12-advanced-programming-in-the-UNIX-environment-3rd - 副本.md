---
layout: post
title:  "读书笔记 ——《Unix环境高级编程》"
date:   2017-10-12
excerpt: "《Unix环境高级编程》(第3版)的笔记，主要记录每个章节的重点部分，以及需要特别注意的细节。"
tag:
- 读书笔记
comments: true
---

本书一共21章。

## 第1章：UNIX基础知识

1. `/etc/passwd文件`为unix的口令文件，口令文件中的登陆项由7个以冒号分隔的字段组成，依次是：登录名、加密口令、数字用户id(UID)、组id(GID)、注释字段、起始目录以及使用的shell程序。其中，真实的用户密码存放在`/etc/shadow`中，组名存放在`/etc/group`中。

		domi:x:500:500::/home/domi:/bin/zsh
		git:x:502:502::/home/git:/bin/bash
2. unix文件系统是目录和文件的一种层次结构，所有东西的起点是称为“根”（`root`）的目录，这个目录的名称是一个字符“`/`”。
3. 文件描述符是一个小的非负整数，内核用来标示一个特定进程正在访问（例如：读文件、写文件、新建文件）的文件。
4. 当运行一个新程序时，shell为其打开3个文件描述符，即标准输入（stdin）、标准输出（stdout）和标准错误（stderr）。可以重定向其中的一个或所有这3个描述符到某个文件。shell把文件描述符0与进程的标准输入关联，描述符1与进程的标注输出关联，描述符2与进程的标准错误关联。
		ls > list.txt

5. 一个进程内的所有线程共享同一地址空间、文件描述符、栈以及进程相关属性。
6. 当unix系统函数出错时，通常会返回一个负值，而且整数变量errno通常被设置为具有特殊信息的值。
7. 系统调用（system call）和C库函数调用的区别：
![系统调用和库函数调用](/images/posts/syscall_clibcall.jpg)

## 第2章：UNIX标准及实现

1. 两个比较常见的标准,参考[这篇文章](http://blog.csdn.net/skylj0209/article/details/3071507)

	- **ANSI C**：这一标准是 ANSI（美国国家标准局）于 1989 年制定的 C 语言标准。 后来被 ISO（国际标准化组织）接受为标准，因此也称为 **ISO C**。它的目标是**为各种操作系统上的 C 程序提供可移植性保证，而不仅仅限于 UNIX**。
	- **POSIX**：该标准最初由 IEEE 开发的标准族，部分已经被 ISO 接受为国际标准。POSIX.1 和 POSIX.2 分别定义了 POSIX 兼容操作系统的 C 语言系统接口 以及 shell 和工具标准。这两个标准是通常提到的标准。POSIX 表示可移植操作系统接口（Portable Operating System Interface ，缩写为 POSIX 是为了读音更 像 UNIX）。塔的目标是**为了提高 UNIX 环境下应用程序的可移植性，而不仅仅局限于UNIX**。
2. 头文件<sys/types.h>定义了某些与实现相关的数据类型，它们被称为**基本系统数据类型**。下表列出了常用的基本系统数据类型。
![常用的基本系统数据类型](/images/posts/primitive_system_data_type.jpg)

## 第3章：文件I/O

1. 文件描述符标志只用于一个进程的一个描述符，而文件状态标志应用于指向该文件表项的任何进程中的描述符。
2. 任何多于一个函数调用的操作都不是原子操作。因为在两个函数调用之间，内核可能会挂起进程。
3. 原子操作指多步操作组成一个操作。执行原子操作，要么执行完所有操作，要么一个操作都不执行。
4. 在`/dev/fd`目录下，有名为0、1、2等的文件，打开文件/dev/fd/n等效于复制描述符（假定描述符n是打开的）。

## 第4章：文件和目录

1. unix文件类型

	- 普通文件
	- 目录文件
	- 块特殊文件，这种类型的文件提供对设备（如磁盘）带缓冲的访问。
	- 字符特殊文件，这种类型的文件提供对设备（如磁盘）不带缓冲的访问。
	- FIFO，用于进程间通讯，命名管道。
	- 套接字，用于进程间网络通讯。
	- 符号链接，用于指向另一个文件，类似快捷方式。

2.
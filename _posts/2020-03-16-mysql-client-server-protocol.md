---
title:  "Mysql 通讯协议"
tag:
- 数据库
---

当我们使用 Mysql 客户端（命令行或者 Navicat 等）与 Mysql 服务器交互时，这些命令是以什么样的方式在网络上传输的？
客户端和服务器是怎样约定的？传输的包的格式是怎么的？带着这些疑惑，本文将对 MySQL 通讯协议进行一个较为深入的讲解。

Mysql 客户端和服务器的通讯支持多种协议，例如： TCP 和 UDP 等。但是，目前使用最多的还是 TCP 连接，因此本文也只探讨 TCP 方式的连接。

现在，我们可以先想象 Mysql 通讯的整个过程：
服务器启动时，服务器会监听一个端口（默认3306端口），当客户端连接时，先经过 TCP 3次握手后，建立网络连接，然后进行身份认证。
认证通过后，这个连接就可以开始工作了，客户端发送命令，然后服务器接收命令、执行命令并返回结果。
当客户端要退出时，则向服务器发送退出命令，服务器返回成功后，则结束这个连接。

这个过程可以分为两个阶段：
- 连接认证阶段
- 命令执行阶段

不管是哪个阶段，通讯本质都是一个发送命令，响应命令的过程。在这个过程中，**MySQL 协议包就是通讯的最小单位**。
一个命令由一个协议包封装，一个请求的返回包可能是一个或者多个。


## 通讯协议简介

什么是 Mysql 协议？

Mysql 协议是用于 Mysql 客户端与服务器之间的**应用层**协议，类似浏览器与 web 服务器通讯的 *http* 协议。
它主要用于：客户端连接、Mysql 代理以及 Mysql 服务器间的主从复制。同时，它还支持以下特性：

- SSL 加密传输
- 压缩传输
- 在连接阶段进行身份认证
- 在命令阶段接受命令并执行



## 协议

## 包

## 包的分类

## 客户端请求包

## 服务器返回包

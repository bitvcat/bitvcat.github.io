---
layout: post
title:  "TCP/IP协议族详解（二）"
date:   2018-03-22
excerpt: "这个系列的文章主要详细了解TCP/IP协议族，本篇主要介绍IP协议"
tag:
- TCP/IP
comments: true
---


本系列文章是**教程：**[TCP、IP协议族详解](http://study.163.com/course/courseMain.htm?courseId=1003343002)的学习笔记。

该系列大概分为下面几个部分：

- 1、TCP/IP协议4层结构以及每层的作用
- 2、IP协议详解
- 3、ARP协议和RARP协议详解
- 4、ICMP协议详解
- 5、TCP协议详解
- 6、UDP协议详解

本文主要介绍TCP/IP网络体系中网络层的IP协议。

## 1、IP协议的功能

IP协议属于网络层众多协议中，最核心的一个协议。它的主要功能有三个：

1. 寻址和路由
2. 传递服务，有两个特点：不可靠（可靠性由上层协议提供，例如TCP协议）；无连接
3. 数据报分段（Segment）和重组

**什么是寻址和路由？**

举一个生活中的例子：假如我要坐火车从广州到北京，选择的路线有很多种，可以坐京广线、也可以先到南昌，然后再去上海，最后去北京等等。怎么选择路线就类似IP协议的寻址和路由。


**为什么传递数据不可靠？**

IP协议一个重要的原则就是：尽最大可能传递数据，但是数据能不能真的到达目的地，IP协议并没有保证。

**数据报分段和重组**

同样一个生活中的例子：如果要运送一个很大的机器，一次性无法运送完，通常的做法是，拆分后把零部件运送到目的地，当所有的零部件都到达目的地后，最后在目的地进行重新组装。


## 2、IP协议头部格式

IP协议头部格式可以分为两个部分：固定部分（20byte）和可变部分（最大可以为40byte）。所以，IP协议的头部最大是60个字节，但是一般情况下都没有可变部分。

下图为IP协议头部格式：
![IP协议头部](/images/posts/tcp-ip/ip-protocol-head.png)
